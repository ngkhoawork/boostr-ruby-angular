#deals
	.deals-filter{'ng-class': '{open: filter.isOpen}'}
		.header
			Filter
			%span.pull-right{'ng-click': 'filter.close($event)'} Close
		.body
			.filter-row
				.filter-name
					%div
						Owner
				.filter-dropdown
					%i.fa.fa-close{'ng-show': 'filter.selected.owner', 'ng-click': 'filter.reset("owner")'}
					%span{'dropdown': '', 'keyboard-nav': '', 'on-toggle': 'filter.onDropdownToggle()'}
						.dropdown-button{'dropdown-toggle': '', 'ng-class': '{selected: filter.selected.owner}'}
							{{filter.selected.owner || 'Select an owner'}}
							%span.caret
						.dropdown-menu{'dropdown-menu': '', role: 'menu'}
							.form-group.dropdown-search{'ng-click': '$event.stopPropagation()'}
								%i.fa.fa-search
								%input.form-control{'placeholder': 'Search', 'ng-model': 'filter.search'}
							%span.dropdown-title Select from list
							.dropdown-option{'ng-repeat': 'owner in filter.owners | filter: filtering | limitTo: 10', role: 'menuitem'}
								%a{href: '', 'ng-click': 'filter.select("owner", owner)'} {{owner}}
			.filter-row
				.filter-name
					%div
						Advertiser
				.filter-dropdown
					%i.fa.fa-close{'ng-show': 'filter.selected.advertiser', 'ng-click': 'filter.reset("advertiser")'}
					%span{'dropdown': '', 'keyboard-nav': '', 'on-toggle': 'filter.onDropdownToggle()'}
						.dropdown-button{'dropdown-toggle': '', 'ng-class': '{selected: filter.selected.advertiser}'}
							{{filter.selected.advertiser.name || 'Select an advertiser'}}
							%span.caret
						.dropdown-menu{'dropdown-menu': '', role: 'menu'}
							.form-group.dropdown-search{'ng-click': '$event.stopPropagation()'}
								%i.fa.fa-search
								%input.form-control{'placeholder': 'Search', 'ng-model': 'filter.search'}
							%span.dropdown-title Select from list
							.dropdown-option{'ng-repeat': 'advertiser in filter.advertisers | filter: filtering | limitTo: 10', role: 'menuitem'}
								%a{href: '', 'ng-click': 'filter.select("advertiser", advertiser)'} {{advertiser.name}}
			.filter-row
				.filter-name
					%div
						Agency
				.filter-dropdown
					%i.fa.fa-close{'ng-show': 'filter.selected.agency', 'ng-click': 'filter.reset("agency")'}
					%span{'dropdown': '', 'keyboard-nav': '', 'on-toggle': 'filter.onDropdownToggle()'}
						.dropdown-button{'dropdown-toggle': '', 'ng-class': '{selected: filter.selected.agency}'}
							{{filter.selected.agency.name || 'Select an agency'}}
							%span.caret
						.dropdown-menu{'dropdown-menu': '', role: 'menu'}
							.form-group.dropdown-search{'ng-click': '$event.stopPropagation()'}
								%i.fa.fa-search
								%input.form-control{'placeholder': 'Search', 'ng-model': 'filter.search'}
							%span.dropdown-title Select from list
							.dropdown-option{'ng-repeat': 'agency in filter.agencies | filter: filtering | limitTo: 10', role: 'menuitem'}
								%a{href: '', 'ng-click': 'filter.select("agency", agency)'} {{agency.name}}
			.filter-row
				.filter-name
					%div
						Budget
				.filter-dropdown
					%i.fa.fa-close{'ng-show': 'filter.selected.budget.min || filter.selected.budget.max', 'ng-click': 'filter.reset("budget")'}
					%span{'dropdown': '', 'on-toggle': 'filter.slider.refresh()'}
						.dropdown-button{'dropdown-toggle': '', 'ng-class': '{selected: filter.selected.budget.min || filter.selected.budget.max}'}
							{{filter.getBudgetValue()}}
							%span.caret
						.dropdown-menu{'dropdown-menu': '', role: 'menu'}
							.dropdown-budget{'ng-click': '$event.stopPropagation()'}
								.budget-range-input
									From
									%input.form-control{'ng-model': 'filter.minBudget', 'ng-change': 'filter.slider.onChangeNumber("min")'}
									to
									%input.form-control{'ng-model': 'filter.maxBudget', 'ng-change': 'filter.slider.onChangeNumber("max")'}
								%rzslider{'rz-slider-model': 'filter.slider.minValue',
										  'rz-slider-high': 'filter.slider.maxValue',
										  'rz-slider-options': 'filter.slider.options'}
			.filter-row
				.filter-name
					%div
						Currency
				.filter-dropdown
					%i.fa.fa-close{'ng-show': 'filter.selected.exchange_rate', 'ng-click': 'filter.reset("exchange_rate")'}
					%span{ 'dropdown': '', 'keyboard-nav': '', 'on-toggle': 'filter.onDropdownToggle()' }
						.dropdown-button{ 'dropdown-toggle': '', 'ng-class': '{selected: filter.selected.exchange_rate}' }
							{{ filter.selected.exchange_rate.currency.name || 'Select a currency' }}
							%span.caret
						.dropdown-menu{'dropdown-menu': '', role: 'menu'}
							.dropdown-option{'ng-repeat': 'exchange_rate in filter.exchange_rates | filter: filtering | limitTo: 10', role: 'menuitem'}
								%a{href: '', 'ng-click': 'filter.select("exchange_rate", exchange_rate)'} {{exchange_rate.currency.name}}
			.filter-row
				.filter-name
					%div
						Start Date
				.filter-dropdown
					%i.fa.fa-close{'ng-show': 'filter.selected.date.startDate && filter.selected.date.endDate', 'ng-click': 'filter.reset("date")'}
					%span.bs-datepicker
						.dropdown-button{'dropdown-toggle': '', 'ng-class': '{selected: filter.selected.date.startDate && filter.selected.date.endDate}'}
							%div.date-picker{'date-range-picker': true,
			                                           'ng-model': 'filter.datePicker.date',
			                                           options: '{eventHandlers: {"apply.daterangepicker": filter.datePicker.apply}}'}
								%span.filter-date {{filter.getDateValue()}}
							%span.caret
			.filter-row
				.filter-name
					%div
						Year Closed
				.filter-dropdown
					%i.fa.fa-close{'ng-show': 'filter.selected.yearClosed', 'ng-click': 'filter.reset("yearClosed")'}
					%span{ 'dropdown': '', 'keyboard-nav': '', 'on-toggle': 'filter.onDropdownToggle()' }
						.dropdown-button{ 'dropdown-toggle': '', 'ng-class': '{selected: filter.selected.yearClosed}' }
							{{ filter.selected.yearClosed || 'Select a year' }}
							%span.caret
						.dropdown-menu{'dropdown-menu': '', role: 'menu'}
							.dropdown-option{'ng-repeat': 'year in filter.dealYears | filter: filtering | limitTo: 10', role: 'menuitem'}
								%a{href: '', 'ng-click': 'filter.select("yearClosed", year)'} {{year}}
		.footer
			%span.reset{'ng-click': 'filter.resetAll()'} Reset
			%button.btn-main.submit{'ng-click': 'filter.apply()'} Apply filters

	.container-fluid
		.row
			.col-xs-12.deals-menu
				%span.title Deals
				%add-button{'ng-click': 'showNewDealModal()'} Add Deal
				.deals-types
					%span{'ng-repeat': 'type in dealTypes', 'ng-class': '{active: type === selectedType}', 'ng-click': 'filterDeals(type)'}
						{{type.name}}
				%button.btn-main.pull-right{'ng-click': 'filter.open($event)'}
					%i.fa.fa-filter
					Add filter
		.row.deals-container
			.deals-table
				.deal-column{'ng-repeat': 'stage in stages', 'ng-init': 'columnIndex = stage.index; $last && coloringColumns()'}
					.column-header
						%span
							{{stage.name}}
							%i ({{columns[columnIndex].length || 0}})
						%span
							{{calcWeighted(columns[columnIndex], stage) | convertCurrency: appliedExchangeRate.rate | formatMoney: appliedExchangeRate.currency.curr_symbol }} (W) / {{calcUnweighted(columns[columnIndex]) | convertCurrency: appliedExchangeRate.rate | formatMoney: appliedExchangeRate.currency.curr_symbol }} (UW)
						%svg{width: '17', height: '72'}
							%polygon{points: '-2,-7 15, 36, -2, 79'}
					.column-body{'dnd-list': 'columns[columnIndex]',
								 'dnd-drop': 'onDrop(item, stage)',
								 'dnd-inserted': 'onInserted(index, columnIndex)'}
						.deal-block{'ng-repeat': 'deal in columns[columnIndex]',
									id: 'deal-{{deal.id}}',
									'ng-click': 'errorTest(deal.id)',
									'dnd-draggable': 'deal',
									'dnd-moved': 'onMoved($index, columnIndex)',
									'dnd-effect-allowed': 'move',
									'dnd-dragstart': 'onDragStart()',
									'dnd-dragend': 'onDragEnd()'}
							.deal-error
							.date.pull-right{'ng-class': '{expired: deal.isExpired}'} {{deal.start_date | date: 'mediumDate'}}
							%span
								%a{'ng-href': '{{"/deals/" + deal.id}}'} {{deal.name}}
							%span {{(deal.advertiser && deal.advertiser.name || '') + ((deal.advertiser && deal.agency) ? ' | ' : '') + (deal.agency && deal.agency.name || '')}}
							%span
								{{deal.budget | convertCurrency: appliedExchangeRate.rate | formatMoney: appliedExchangeRate.currency.curr_symbol }}
								%i &#183;
								{{deal.members ? deal.members.join(', ') : '-'}}
							%div.block-menu
								%div{'dropdown': '', 'keyboard-nav': ''}
									%i.fa.fa-ellipsis-h{'dropdown-toggle': '', 'ng-class': '{selected: filter.selected.advertiser}'}
									.dropdown-menu{'dropdown-menu': '', role: 'menu'}
										.dropdown-option
											%a{href: '', 'ng-click': 'showDealEditModal(deal)'} Edit
										.dropdown-option
											%a{href: '', 'ng-click': 'deleteDeal(deal)'} Delete