#revenue.sales-execution-dashboard
  #nav.transparent
    .container
      .row.filter-section
        .col-xs-4.col-xs-offset-2
          %tree-dropdown{ class:"tree-dropdown team-list", data:"teams", selected:"selectedTeam"}
        .col-xs-4
          %div.member-list{ dropdown: true }
            %a{ href: '', dropdown: { toggle: true } }
              %p{ class: "select" }
                {{ selectedMember.name ? selectedMember.name : "Select Member" }}
            %ul.dropdown-menu.members
              %li{ ng: { repeat: 'member in selectedTeam.members', class: '{active: member.id == selectedMember.id}' } }
                %a{ href: '', ng: { click: 'changeMember(member)' } }
                  {{ member.name }}


  .container-fluid
    .row
      .col-md-4
        .table-wrapper
          %h3
            This Quarter - {{dataQuaterForecast[0].new_deals_needed}} Deals Needed
          %nvd3{ options:'optionsQuarterForecast[0]', data: 'dataQuaterForecast[0].graphData', callback:"initLabels()", class: 'quarter-forecast-chart1', ng: {if: 'dataQuaterForecast[0]'}}
        .table-wrapper
          %table.table.table-hover.table-striped
            %thead
              %tr
                %th.center Quota
                %th.center Weighted Pipe
                %th.center Revenue
                %th.center Forecast
                %th.center % Quota
                %th.center # Deals Needed
            %tbody{ng: {if: "dataQuaterForecast[0]"}}
              %tr
                %td.center {{dataQuaterForecast[0].quota | currency: '$' : 0}}
                %td.center {{dataQuaterForecast[0].weighted_pipeline | currency: '$' : 0}}
                %td.center {{dataQuaterForecast[0].revenue | currency: '$' : 0}}
                %td.center {{(dataQuaterForecast[0].weighted_pipeline + dataQuaterForecast[0].revenue) | currency: '$' : 0}}
                %td.center {{dataQuaterForecast[0].percent_to_quota.toFixed(0)}}%
                %td.center {{dataQuaterForecast[0].new_deals_needed}}
      .col-md-4
        .table-wrapper
          %h3
            KPIs
          %table.table.table-hover.table-striped
            %thead
              %tr
                %th.center Win Rate
                %th.center Deal Size
                %th.center Cycle Time


            %tbody
              %tr
                %td.center {{averageWinRate}}% / {{allAverageWinRate}}% (ave)
                %td.center {{averageDealSize | currency: '$' : 0}}k / {{allAverageDealSize | currency: '$' : 0}}k (ave)
                %td.center {{averageCycleTime}}d / {{allAverageCycleTime}}d (ave)
        .table-wrapper
          %h3
            Largest Open Deals
          %table.table.table-hover.table-striped
            %thead
              %tr
                %th.left Client
                %th.left Budget
                %th.left %
                %th.left Start Date
                %th.right Next Step


            %tbody
              %tr{ 'ng-repeat': 'deal in topDeals' }
                %td.left {{ deal.advertiser.name }}
                %td.left {{deal.budget/100 | currency: '$' : 0}}
                %td.left {{deal.stage.probability}}
                %td.left {{deal.start_date | date:'MM-dd-yyyy'}}
                %td.right {{deal.next_steps}}
        .table-wrapper
          %h3
            Weekly Pipeline Movement
          %table.table-bar-charts
            %tbody
              %tr{ 'ng-repeat': 'item in chartWeekPipeMovement'}
                %td.left
                  {{item.name}}
                %td.bar-section
                  %div.bar{ng: { style: 'item.styles'}}
                    %span
                      {{item.value | currency: '$' : 0}}
                %td.right

        .table-wrapper
          %h3
            Pipeline by Product
          %nvd3{ options:'optionsProductPipeline', data: 'dataProductPipeline', class: '.product-pipeline-chart', ng: {if: 'dataProductPipeline'}}
          %div{ class: "product-pipeline-choice" }
            %div{ ng: {class: '{active: productPipelineChoice == "weighted"}', click: 'changeProductPipelineChoice("weighted")'} }
              Weighted
            %div{ ng: {class: '{active: productPipelineChoice == "unweighted"}', click: 'changeProductPipelineChoice("unweighted")' } }
              Unweighted
      .col-md-4
        .table-wrapper
          %h3
            Next Quarter - {{dataQuaterForecast[1].new_deals_needed}} Deals Needed
          %nvd3{ options:'optionsQuarterForecast[1]', data: 'dataQuaterForecast[1].graphData', callback:"initLabels()", class: 'quarter-forecast-chart2', ng: {if: 'dataQuaterForecast[1]'}}
        .table-wrapper
          %table.table.table-hover.table-striped
            %thead
              %tr
                %th.center Quota
                %th.center Weighted Pipe
                %th.center Revenue
                %th.center Forecast
                %th.center % Quota
                %th.center # Deals Needed
            %tbody{ng: {if: "dataQuaterForecast[1]"}}
              %tr
                %td.center {{dataQuaterForecast[1].quota | currency: '$' : 0}}
                %td.center {{dataQuaterForecast[1].weighted_pipeline | currency: '$' : 0}}
                %td.center {{dataQuaterForecast[1].revenue | currency: '$' : 0}}
                %td.center {{(dataQuaterForecast[1].weighted_pipeline + dataQuaterForecast[1].revenue) | currency: '$' : 0}}
                %td.center {{dataQuaterForecast[1].percent_to_quota.toFixed(0)}}%
                %td.center {{dataQuaterForecast[1].new_deals_needed}}