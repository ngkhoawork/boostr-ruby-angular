#deal
  .container
    .row.return
      .col-xs-12
        %a{ href:'/deals' }
          = inline_svg 'caret.svg', class: 'transform'
          Back to Deals

  .container
    #deal_overview.row.campaign
      .col-xs-9
        %h3.deal-name {{ currentDeal.name }}
      #stage_overview.col-xs-3.pull-right
        .panel.current-stage
          .panel-heading
            .panel-title current stage
          .panel-body
            .col-xs-2
              .stage{ style: "border-color: {{ currentDeal.stage.color }}; background-color: {{ currentDeal.stage.color }};" }
            .col-xs-7.details
              .row.type {{ currentDeal.stage.name }}
              .row.probability {{ currentDeal.stage.probability }}% probability
            .col-xs-3
  .container
    #nav.transparent
      .row
        .col-xs-12
          %ul.nav.nav-tabs
            %li.active
              %a
                campaign
            %li
              %a
                team & split
            %li
              %a
                documents
            %li
              %a
                additional info
            %li.pull-right.nav-text.last
              Updated {{ currentDeal.updated_at | date: 'MMMM d, y' }}
    %h3.header
      Campaign
    .well
      .row
        .col-xs-3.campaign-period
          .row
            .col-xs-12
              Campaign Period
          .row
            .col-xs-12
              %h4
                {{ currentDeal.start_date | date: 'MMM d, y' }} - {{ currentDeal.end_date | date: 'MMM d, y' }}
        .col-xs-2.campaign-period.text-center
          .row
            .col-xs-12
              Total Amount
          .row
            .col-xs-12
              %h4#total-amount
                {{ currentDeal.budget / 100 | currency: '$': 0 }}
        .col-xs-2.campaign-period.text-center
          .row
            .col-xs-12
              Forecast Amount
          .row
            .col-xs-12
              %h4
                $125,000
    #revenue_schedule.table-wrapper
      %table.table.white-table
        %thead
          %tr
            %th Product
            %th{ ng: { repeat: 'month in currentDeal.months' } }
              {{ month | boDate }}

        %tbody
          %tr{ ng: { repeat: 'product in currentDeal.products' } }
            %td
              {{ product.name }}
            %td{ ng: { repeat: 'deal_product in product.deal_products' }}
              {{ deal_product.budget / 100 | currency:'$':0 }}

    #new-product.well.dark
      .row{ ng: { hide: 'showProductForm' } }
        .col-xs-12
          %a.add-product{ href: '', ng: { click: 'toggleProductForm()' } }
            = inline_svg 'add.svg'
            Add Product
      .row{ ng: { show: 'showProductForm' } }
        .col-xs-12
          %form#product-form{ ng: { submit: 'addProduct()' } }
            .row
              .col-xs-2
                .row.bordered
                  .col-xs-12
                    .form-group
                      %label.control-label{ for: 'product' } Product
                      %ui-select{ name: 'product', ng: { model: 'deal_product.product_id', disabled: true, required: true } }
                        %ui-select-match{ placeholder: 'Product' }
                          {{ $select.selected.name }}
                        %ui-select-choices{ repeat: 'product.id as product in products | filter: { name: $select.search }' }
                          %div{ ng: { bind: { html: 'product.name' } } }
                .row.bordered
                  .col-xs-12
                    .form-group
                      %label.control-label{ for: 'total_budget' } Total Budget
                      %input.form-control{ placeholder: 'Total Budget', ng: { model: 'deal_product.total_budget', required: true }, name: 'total_budget' }
                .row
                  .col-xs-12
                    %button.btn.btn-primary.btn-block{ type: 'submit' } Add Product
              .col-xs-10
                .row.months
                  .col-xs-2{ ng: { repeat: 'month in deal_product.months' } }
                    .form-group
                      %label.control-label Month \#{{ $index + 1 }}
                      %input.form-control{ ng: { model: 'month.value'}, disabled: true }

    #add_info.col-xs-6.pull-right
      %h3.header Additional Info
      .well
        .row.field
          .col-xs-10
            .row
              .col-xs-4
                %h4.field-label Type
            .row
              .col-xs-9.field-value
                {{ currentDeal.deal_type }}
        .row.field
          .col-xs-10
            .row
              .col-xs-4
                %h4.field-label Source
            .row
              .col-xs-9.field-value
                {{ currentDeal.source_type }}
        .row.field
          .col-xs-10
            .row
              .col-xs-4
                %h4.field-label Next Steps
            .row
              .col-xs-9.field-value
                {{ currentDeal.next_steps }}
        .row.field
          .col-xs-10
            .row
              .col-xs-4
                %h4.field-label Created
            .row
              .col-xs-9.field-value
                {{ currentDeal.creator.first_name }} {{ currentDeal.creator.last_name }} on {{ currentDeal.created_at | date: 'shortDate' }} @ {{ currentDeal.created_at | date: 'shortTime'}}
