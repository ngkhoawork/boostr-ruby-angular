#deal_modal
  %form{ ng: { submit: 'submitForm()' } }
    .modal-header.text-center
      %a.close{ ng: { click: 'cancel()' } }
        %span{'aria-hidden' => 'true'}
          = inline_svg 'close.svg'
      %h3.modal-title
        %strong
          {{ formType }} Deal
    .modal-body
      .form-group
        %label.control-label{ for: 'name' } Name
        %input.form-control{ placeholder: 'Name', ng: { model: 'deal.name', required: true }, name: 'name' }

      .form-group
        %label.control-label{ for: 'stage' } Stage
        %ui-select{ name: 'stage', ng: { model: 'deal.stage_id', disabled: true } }
          %ui-select-match{ placeholder: 'Stage' }
            {{ $select.selected.name }}
          %ui-select-choices{ repeat: 'stage.id as stage in stages | filter: { name: $select.search }' }
            %div{ ng: { bind: { html: 'stage.name' } } }

      .form-group
        %label.control-label{ for: 'budget' } Total Budget
        %input.form-control{ placeholder: 'Total Budget', ng: { model: 'deal.budget' }, name: 'budget' }

      .form-group
        .row
          .col-xs-6
            %label.control-label{ for: 'advertiser' } Advertiser
            %ui-select{ name: 'advertiser', ng: { model: 'deal.advertiser_id', disabled: true, required: true } }
              %ui-select-match{ placeholder: 'Advertiser' }
                {{ $select.selected.name }}
              %ui-select-choices{ repeat: 'advertiser.id as advertiser in clients | filter: { name: $select.search, client_type: "Advertiser" }' }
                %div{ ng: { bind: { html: 'advertiser.name' } } }
          .col-xs-6
            %label.control-label{ for: 'agency' } Agency
            %ui-select{ name: 'agency', ng: { model: 'deal.agency_id', disabled: true } }
              %ui-select-match{ placeholder: 'Agency' }
                {{ $select.selected.name }}
              %ui-select-choices{ repeat: 'agency.id as agency in clients | filter: { name: $select.search, client_type: "Agency" }' }
                %div{ ng: { bind: { html: 'agency.name' } } }

      .form-group
        .row
          .col-xs-6
            %label.control-label{ for: 'deal-type' } Type
            %ui-select{ name: 'deal-type', ng: { model: 'deal.deal_type', disabled: true } }
              %ui-select-match{ placeholder: 'Type' }
                {{ $select.selected }}
              %ui-select-choices{ repeat: 'dealType in dealTypes | filter: $select.search' }
                %div{ ng: { bind: { html: 'dealType' } } }
          .col-xs-6
            %label.control-label{ for: 'source-type' } Source
            %ui-select{ name: 'source-type', ng: { model: 'deal.source_type', disabled: true } }
              %ui-select-match{ placeholder: 'Source' }
                {{ $select.selected }}
              %ui-select-choices{ repeat: 'sourceType in sourceTypes | filter: $select.search' }
                %div{ ng: { bind: { html: 'sourceType' } } }

      .form-group
        %label.control-label{ for: 'next_steps' } Next Steps
        %input.form-control{ placeholder: 'Next Steps', ng: { model: 'deal.next_steps' }, name: 'next_steps' }

      .form-group
        .row
          .col-md-6.bs-datepicker
            %label.control-label{ for: 'start-date' } Start Date
            %input.form-control{ name: 'start-date', type: 'text', datepicker: { popup: 'MMMM d, y' }, ng: { model: 'deal.start_date', required: true, click: 'startOpened = true' }, 'is-open': 'startOpened' }

          .col-md-6.bs-datepicker
            %label.control-label{ for: 'end-date' } End Date
            %input.form-control{ name: 'end-date', type: 'text', datepicker: { popup: 'MMMM d, y' }, ng: { model: 'deal.end_date', required: true, click: 'endOpened = true' }, 'is-open': 'endOpened' }

    .modal-footer.text-center
      %button.btn.btn-primary.btn-lg{ type: 'submit' } {{ submitText }}
      %a.btn.btn-default.btn-lg{ ng: { click: 'cancel()' } } Cancel
